
<!DOCTYPE html>
<html lang="zh-CN">


<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#202020"/>
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>
  
  
    <meta name="keywords" content="æ•°æ®ç»“æ„,ç®—æ³•," />
  

  
    <meta name="description" content="å¤§æ‚²æ— æ³ªï¼Œå¤§æ‚Ÿæ— è¨€ï¼Œå¤§ç¬‘æ— å£°ã€‚" />
  
  
  
  <link rel="icon" type="image/x-icon" href="/img/cat.ico">
  
  <title>KMPç®—æ³• [ iMlGw0 ]</title>
  
    <!-- stylesheets list from config.yml -->
    
      <link rel="stylesheet" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css">
    
      <link rel="stylesheet" href="/css/xoxo.css">
    
  
<meta name="generator" content="Hexo 4.2.0"><link rel="stylesheet" href="/css/prism.css" type="text/css"></head>


<body>
  <div class="nav-container">
    <nav class="home-menu pure-menu pure-menu-horizontal">
  <a class="pure-menu-heading" href="/">
    
    <span class="title" style="text-transform:none">iMlGw0</span>
  </a>

  <ul class="pure-menu-list clearfix">
      
          
            
              <li class="pure-menu-item"><a href="/" class="pure-menu-link">é¦–é¡µ</a></li>
            
          
      
          
            
              <li class="pure-menu-item pure-menu-has-children pure-menu-allow-hover">
            
              <a href="#" id="post" class="pure-menu-link">æ–‡ç« </a>
              <ul class="pure-menu-children">
              
                  
                    <li class="pure-menu-item"><a href="/categories" style="color:#202020;" class="pure-menu-link">åˆ†ç±»</a></li>
                  
              
                  
                    <li class="pure-menu-item"><a href="/archives" style="color:#202020;" class="pure-menu-link">å½’æ¡£</a></li>
                  
              
                  
                    <li class="pure-menu-item"><a href="/tags" style="color:#202020;" class="pure-menu-link">æ ‡ç­¾</a></li>
                  
              
              </ul>
            </li>
          
      
          
            
              <li class="pure-menu-item pure-menu-has-children pure-menu-allow-hover">
            
              <a href="#" id="LeetCode" class="pure-menu-link">LeetCode</a>
              <ul class="pure-menu-children">
              
                  
                    <li class="pure-menu-item"><a href="http://imlgw.top/2019/05/04/leetcode-shu-zu/" style="color:#202020;" class="pure-menu-link">æ•°ç»„</a></li>
                  
              
                  
                    <li class="pure-menu-item"><a href="http://imlgw.top/2019/02/27/leetcode-lian-biao/" style="color:#202020;" class="pure-menu-link">é“¾è¡¨</a></li>
                  
              
                  
                    <li class="pure-menu-item"><a href="http://imlgw.top/2019/10/01/leetcode-zhan-dui-lie/" style="color:#202020;" class="pure-menu-link">æ ˆ&amp;é˜Ÿåˆ—</a></li>
                  
              
                  
                    <li class="pure-menu-item"><a href="http://imlgw.top/2019/09/15/leetcode-cha-zhao/" style="color:#202020;" class="pure-menu-link">æŸ¥æ‰¾</a></li>
                  
              
                  
                    <li class="pure-menu-item"><a href="http://imlgw.top/2019/07/20/leetcode-hua-dong-chuang-kou/" style="color:#202020;" class="pure-menu-link">æ»‘åŠ¨çª—å£</a></li>
                  
              
                  
                    <li class="pure-menu-item"><a href="http://imlgw.top/2019/09/01/leetcode-dong-tai-gui-hua/" style="color:#202020;" class="pure-menu-link">åŠ¨æ€è§„åˆ’</a></li>
                  
              
                  
                    <li class="pure-menu-item"><a href="http://imlgw.top/2019/12/06/leetcode-er-fen-cha-zhao/" style="color:#202020;" class="pure-menu-link">äºŒåˆ†æŸ¥æ‰¾</a></li>
                  
              
                  
                    <li class="pure-menu-item"><a href="http://imlgw.top/2019/11/06/leetcode-er-cha-shu/" style="color:#202020;" class="pure-menu-link">äºŒå‰æ ‘</a></li>
                  
              
                  
                    <li class="pure-menu-item"><a href="http://imlgw.top/2019/11/29/leetcode-bei-bao-wen-ti/" style="color:#202020;" class="pure-menu-link">èƒŒåŒ…é—®é¢˜</a></li>
                  
              
                  
                    <li class="pure-menu-item"><a href="http://imlgw.top/2019/10/10/leetcode-hui-su/" style="color:#202020;" class="pure-menu-link">å›æº¯</a></li>
                  
              
                  
                    <li class="pure-menu-item"><a href="http://imlgw.top/2020/01/21/leetcode-tan-xin/" style="color:#202020;" class="pure-menu-link">è´ªå¿ƒ</a></li>
                  
              
              </ul>
            </li>
          
      
          
            
              <li class="pure-menu-item"><a href="/project" class="pure-menu-link">é¡¹ç›®</a></li>
            
          
      
          
            
              <li class="pure-menu-item"><a href="/search" class="pure-menu-link">æœç´¢</a></li>
            
          
      
          
            
              <li class="pure-menu-item"><a href="/about" class="pure-menu-link">å…³äº</a></li>
            
          
      
  </ul>
   
</nav>

  </div>

  <div class="container" id="content-outer">
    <div class="inner" id="content-inner">
      <div class="post-container">
  <article class="post" id="post">
    <header class="post-header text-center">
      <h1 class="title">
        KMPç®—æ³•
      </h1>
      <span>
        
        <time class="time" datetime="2020-05-13T06:53:34.712Z">
        2020-05-13
      </time>
        
      </span>
      <span class="slash">/</span>
      <span class="post-meta">
      <span class="post-tags">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" rel="tag">æ•°æ®ç»“æ„</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">ç®—æ³•</a></li></ul>
      </span>
    </span>
      <span class="slash">/</span>
      <span class="read">
      <span id="busuanzi_value_page_pv"></span> ç‚¹å‡»
    </span>
      <span class="slash">/</span>
      <span class="read">é˜…è¯»è€—æ—¶ 15 åˆ†é’Ÿ</span>
    </header>

    <div class="post-content">
      <h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä¹‹å‰å¤§ä¸€çš„æ—¶å€™å†™è¿‡ä¸€ç¯‡å…³äºKMPçš„åšå®¢ï¼Œå†™çš„ä¹Ÿæ˜¯ä¹±ä¸ƒå…«ç³Ÿçš„ï¼Œè‡ªå·±çœ‹ç€éƒ½è´¹åŠ²ï¼Œæœ€è¿‘çœ‹å·¦ç¥çš„ä¹¦ã€Šç¨‹åºå‘˜ä»£ç é¢è¯•æŒ‡å—ã€‹æœ‰è®²ï¼Œé‡æ–°å­¦äº†ä¸€éï¼Œæ„Ÿè§‰å†™çš„è¿˜æ˜¯æŒºå¥½çš„ï¼Œè¿™ç¯‡å°±ä¸ä»0å¼€å§‹è®²è§£<code>KMP</code>äº†ï¼Œç®€å•è¯´ä¸€äº›è¦ç‚¹ï¼Œæ–¹ä¾¿ä»¥åå›é¡¾</p>
<blockquote>
<p>æˆ‘è®°å¾—å¤§ä¸€ä¸ºäº†ææ‡‚kmpå¥½åƒèŠ±äº†æŒºé•¿æ—¶é—´çš„ï¼Œç½‘ä¸Šç¿»å„ç§åšå®¢ï¼Œæäº†å¤§åŠå¤©å§ï¼Œç»“æœè¿˜æ˜¯æ²¡å’‹ææ¸…æ¥šï¼Œå‰å‡ å¤©çœ‹ä¹¦å¤§æ¦‚åªèŠ±äº†ä¸€ä¸ªå°æ—¶å·¦å³å°±éƒ½ææ¸…æ¥šäº†ï¼Œå¯èƒ½æ˜¯å·¦ç¥å†™çš„æ¯”è¾ƒå¥½å§ğŸ˜‚</p>
</blockquote>
<h2 id="nextæ•°ç»„æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#nextæ•°ç»„æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="nextæ•°ç»„æ˜¯ä»€ä¹ˆï¼Ÿ"></a>nextæ•°ç»„æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p><code>kmp</code>æœ€å…³é”®çš„åœ°æ–¹å°±æ˜¯è¿™ä¸ª<code>next</code>æ•°ç»„äº†ï¼Œ<code>next</code>æ•°ç»„å°±æ˜¯å„ä¸ªå­ä¸²çš„å‰ç¼€åç¼€æœ€å¤§åŒ¹é…ï¼ˆç›¸ç­‰ï¼‰é•¿åº¦ï¼Œå…·ä½“ä¸€ç‚¹å°±æ˜¯<code>next[i]</code>ä»£è¡¨çš„å°±æ˜¯å­ä¸²<code>i</code>ä½ç½®å‰å­—ç¬¦ï¼ˆä¸åŒ…æ‹¬<code>i</code>ä½ç½®ï¼‰çš„å‰åç¼€æœ€å¤§åŒ¹é…é•¿åº¦</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼š å­ä¸²<code>abababc</code>  </p>
<p>next[3] = â€œabaâ€ çš„å‰åç¼€æœ€å¤§åŒ¹é…é•¿åº¦ = 1 (å¼€å¤´çš„aå’Œç»“å°¾çš„aåŒ¹é…)</p>
<p>next[6]= â€œabababâ€ çš„å‰åç¼€æœ€å¤§åŒ¹é…é•¿åº¦ = 4 ï¼ˆå¼€å¤´çš„ababå’Œç»“å°¾çš„ababåŒ¹é…ï¼‰</p>
<h2 id="nextæ•°ç»„çš„ä½œç”¨ï¼Ÿ"><a href="#nextæ•°ç»„çš„ä½œç”¨ï¼Ÿ" class="headerlink" title="nextæ•°ç»„çš„ä½œç”¨ï¼Ÿ"></a>nextæ•°ç»„çš„ä½œç”¨ï¼Ÿ</h2><p>ä»–çš„ä½œç”¨å…¶å®å°±æ˜¯åœ¨ä¸¤ä¸ªå­—ç¬¦ä¸²æ¯”è¾ƒå¤±é…çš„æ—¶å€™é¿å…ç›®æ ‡ä¸²å›æº¯ï¼Œå¸¸è§„çš„æš´åŠ›åŒ¹é…åœ¨å­—ç¬¦å¤±é…çš„æ—¶å€™å°±ä¼šå›é€€åˆ°é¦–å­—ç¬¦é‡æ–°åŒ¹é…ï¼Œæ•´ä½“æ—¶é—´å¤æ‚åº¦å°±æ˜¯<code>O(m*n)</code>ï¼Œè€Œnextæ•°ç»„å°±æ˜¯ä¸ºäº†é¿å…å›é€€ï¼Œç®€å•ä¸¾ä¸€ä¸ªä¾‹å­</p>
<p><img src="http://static.imlgw.top/blog/20200513/ugvgLhmyaeBr.png?imageslim" alt="mark"></p>
<p>ç”¨PPTç®€å•çš„ç”»äº†ä¸ªå›¾ï¼ˆPPTçœŸå¥½ç”¨ï¼‰ï¼Œå½“åŒ¹é…åˆ°<strong>æ¯ä¸²å’Œå­ä¸²</strong><code>index=6</code>çš„ä½ç½®æ—¶ï¼Œå‘ç°ä¸¤è€…çš„å­—ç¬¦ä¸ç›¸åŒï¼ŒæŒ‰ç…§æš´åŠ›åŒ¹é…ï¼Œä¸‹ä¸€æ­¥å°±æ˜¯æ¯ä¸²å›æº¯åˆ°<code>index=1</code>ä¹Ÿå°±æ˜¯bå­—ç¬¦ä½ç½®ï¼Œå­ä¸²å›æº¯åˆ°é¦–å­—ç¬¦ï¼Œé‡æ–°å¼€å§‹åŒ¹é…ï¼Œç›´åˆ°åŒ¹é…åˆ°å­ä¸²ï¼Œæˆ–è€…åŒ¹é…å®Œæ¯ä¸²æ‰€æœ‰å­ä¸²ï¼Œä½†æ˜¯å½“æˆ‘ä»¬æœ‰äº†<code>next</code>æ•°ç»„ï¼Œæˆ‘ä»¬çš„æ¯ä¸²å°±ä¸å¿…å†å›é€€äº†ï¼Œè€Œå­ä¸²ä¹Ÿä¸å¿…å†å›é€€åˆ°é¦–å­—ç¬¦äº†ï¼Œå›¾ä¸­çš„é»„è‰²ä¸‹åˆ’çº¿å’Œç»¿è‰²ä¸‹åˆ’çº¿ä»£è¡¨çš„å°±æ˜¯<strong>å­ä¸²index=6</strong>ä½ç½®å‰çš„æœ€é•¿å‰åç¼€åŒ¹é…é•¿åº¦ï¼Œä¹Ÿå°±æ˜¯<code>ababab</code>çš„<strong>æœ€é•¿å‰åç¼€åŒ¹é…å­—ç¬¦</strong>ï¼Œå½“å­ä¸²index=6ä½ç½®çš„å­—ç¬¦åŒ¹é…ä¸ä¸Šçš„æ—¶å€™æˆ‘ä»¬æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥å°†<code>index</code>è·³åˆ°<code>next[6]</code>ï¼Œä¹Ÿå°±æ˜¯å°†å­ä¸²ç´¢å¼•ç§»åŠ¨åˆ°index=4çš„ä½ç½®ï¼Œå°±å˜æˆä¸‹é¢è¿™æ ·</p>
<p><img src="http://static.imlgw.top/blog/20200513/6sBvml0hXrr6.png?imageslim" alt="mark"></p>
<p>æ¯ä¸²å¹¶æ²¡æœ‰å›é€€ï¼Œç»§ç»­åŒ¹é…<code>æ¯ä¸²index=6</code>å’Œå­ä¸²<code>index=4</code>ä½ç½®çš„å…ƒç´ ï¼Œç„¶åé‡å¤ä¸Šé¢çš„è¿‡ç¨‹</p>
<h2 id="ä¸ºä»€ä¹ˆå­ä¸²å¯ä»¥ç›´æ¥æ»‘åŠ¨next-i-æ­¥ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆå­ä¸²å¯ä»¥ç›´æ¥æ»‘åŠ¨next-i-æ­¥ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆå­ä¸²å¯ä»¥ç›´æ¥æ»‘åŠ¨next[i]æ­¥ï¼Ÿ"></a>ä¸ºä»€ä¹ˆå­ä¸²å¯ä»¥ç›´æ¥æ»‘åŠ¨next[i]æ­¥ï¼Ÿ</h2><p>å‰é¢æˆ‘ä»¬çŸ¥é“äº†å¦‚ä½•ä½¿ç”¨<code>next</code>æ•°ç»„ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆå­ä¸²å¯ä»¥ä¸€ä¸‹å­ä»æ»‘åŠ¨åˆ°<code>next[i]</code>ä½ç½®å‘¢ï¼Ÿä¸‡ä¸€ä¸­é—´æœ‰èƒ½åŒ¹é…çš„å­—ç¬¦ä¸å°±æ»‘è¿‡äº†ä¹ˆï¼Ÿ</p>
<p>æˆ‘ä»¬å‡è®¾åœ¨æ¯ä¸²ä¸­é—´å­˜åœ¨æŸä¸€ä¸ªä½ç½®èƒ½åŒ¹é…å‡ºå­ä¸²ï¼Œä¸”è¯¥ä½ç½®åœ¨<strong>å­ä¸²æœ€é•¿åŒ¹é…åç¼€ä¹‹å‰</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™éƒ¨åˆ†<strong>æ¯”å½“å‰çš„æœ€é•¿å‰åç¼€åŒ¹é…é•¿åº¦è¿˜è¦é•¿</strong>å¯¹åº”åˆ°ä¸‹å›¾å°±æ˜¯é»‘è‰²è™šçº¿æ¡†æ¡†å‡ºæ¥çš„éƒ¨åˆ†</p>
<p><img src="http://static.imlgw.top/blog/20200513/EbC0E1JvbkHh.png?imageslim" alt="mark"></p>
<p>æ—¢ç„¶èƒ½ä»è¿™ä¸ªä½ç½®åŒ¹é…å‡ºå­ä¸²ï¼Œé‚£ä¹ˆè¯´æ˜æˆ‘çš„<strong>å­ä¸²çš„å‰ç¼€</strong>å’Œè¿™ä¸€éƒ¨åˆ†ç›¸ç­‰ï¼ŒåŒæ—¶ï¼Œç”±äºå¤±é…å‰å­ä¸²å’Œæ¯ä¸²æ˜¯å®Œå…¨åŒ¹é…çš„ï¼Œæ‰€ä»¥æˆ‘<strong>å­ä¸²çš„åç¼€</strong>å’Œè¿™ä¸€éƒ¨åˆ†è‚¯å®šä¹Ÿæ˜¯ç›¸ç­‰çš„ï¼Œè¯¶ï¼Ÿæˆ‘å­ä¸²å‰åç¼€éƒ½å’Œè¿™éƒ¨åˆ†ç›¸ç­‰ï¼Œé‚£å®ƒè‚¯å®šæ˜¯æˆ‘çš„åŒ¹é…å‰åç¼€å•Šï¼Œä½†æ˜¯è¿™éƒ¨åˆ†åˆæ¯”æˆ‘çš„æœ€é•¿å‰åç¼€é•¿åº¦è¦é•¿ï¼Œæ˜¯ä¸æ˜¯çŸ›ç›¾äº†ï¼Ÿæ‰€ä»¥åŸå‡è®¾æ˜¯ä¸æˆç«‹çš„ï¼Œä¸å­˜åœ¨è¿™æ ·çš„ä½ç½®ï¼æ‰€ä»¥å­ä¸²å¯ä»¥æ”¾å¿ƒçš„æ»‘åˆ°<code>next[i]</code>ä½ç½®</p>
<h2 id="nextæ•°ç»„å¦‚ä½•æ±‚ï¼Ÿ"><a href="#nextæ•°ç»„å¦‚ä½•æ±‚ï¼Ÿ" class="headerlink" title="nextæ•°ç»„å¦‚ä½•æ±‚ï¼Ÿ"></a>nextæ•°ç»„å¦‚ä½•æ±‚ï¼Ÿ</h2><p>è¯´äº†è¿™ä¹ˆå¤šnextæ•°ç»„ï¼Œé‚£ä¹ˆnextæ•°ç»„ç©¶ç«Ÿæ€ä¹ˆæ±‚å‘¢ï¼Ÿå…¶å®æ•´ä¸ªçš„æ±‚è§£è¿‡ç¨‹æœ‰ç‚¹åƒåŠ¨æ€è§„åˆ’ï¼Œæœ‰ä¸€äº›ç»†èŠ‚éœ€è¦æ³¨æ„ä¸‹</p>
<blockquote>
<p>æƒ³èµ·æ¥äº†å†å†™</p>
</blockquote>
<h2 id="æ—¶é—´å¤æ‚åº¦ä¸ºä»€ä¹ˆæ˜¯çº¿æ€§çš„ï¼Ÿ"><a href="#æ—¶é—´å¤æ‚åº¦ä¸ºä»€ä¹ˆæ˜¯çº¿æ€§çš„ï¼Ÿ" class="headerlink" title="æ—¶é—´å¤æ‚åº¦ä¸ºä»€ä¹ˆæ˜¯çº¿æ€§çš„ï¼Ÿ"></a>æ—¶é—´å¤æ‚åº¦ä¸ºä»€ä¹ˆæ˜¯çº¿æ€§çš„ï¼Ÿ</h2><blockquote>
<p>æƒ³èµ·æ¥äº†å†å†™</p>
</blockquote>
<h2 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h2><h3 id="28-å®ç°-strStr"><a href="#28-å®ç°-strStr" class="headerlink" title="28. å®ç° strStr()"></a><a href="https://leetcode-cn.com/problems/implement-strstr/" target="_blank" rel="noopener">28. å®ç° strStr()</a></h3><p>å®ç° <a href="https://baike.baidu.com/item/strstr/811469" target="_blank" rel="noopener">strStr()</a> å‡½æ•°ã€‚</p>
<p>ç»™å®šä¸€ä¸ª haystack å­—ç¬¦ä¸²å’Œä¸€ä¸ª needle å­—ç¬¦ä¸²ï¼Œåœ¨ haystack å­—ç¬¦ä¸²ä¸­æ‰¾å‡º needle å­—ç¬¦ä¸²å‡ºç°çš„ç¬¬ä¸€ä¸ªä½ç½® (ä»0å¼€å§‹)ã€‚å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¿”å›  <strong>-1</strong>ã€‚</p>
<p><strong>ç¤ºä¾‹ 1:</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">è¾“å…¥: haystack = <span class="string">"hello"</span>, needle = <span class="string">"ll"</span></span><br><span class="line">è¾“å‡º: <span class="number">2</span></span><br></pre></td></tr></table></figure>

<p><strong>ç¤ºä¾‹ 2:</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">è¾“å…¥: haystack = <span class="string">"aaaaa"</span>, needle = <span class="string">"bba"</span></span><br><span class="line">è¾“å‡º: -<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p><strong>è¯´æ˜:</strong></p>
<p>å½“ <code>needle</code> æ˜¯ç©ºå­—ç¬¦ä¸²æ—¶ï¼Œæˆ‘ä»¬åº”å½“è¿”å›ä»€ä¹ˆå€¼å‘¢ï¼Ÿè¿™æ˜¯ä¸€ä¸ªåœ¨é¢è¯•ä¸­å¾ˆå¥½çš„é—®é¢˜ã€‚</p>
<p>å¯¹äºæœ¬é¢˜è€Œè¨€ï¼Œå½“ <code>needle</code> æ˜¯ç©ºå­—ç¬¦ä¸²æ—¶æˆ‘ä»¬åº”å½“è¿”å› 0 ã€‚è¿™ä¸Cè¯­è¨€çš„ <a href="https://baike.baidu.com/item/strstr/811469" target="_blank" rel="noopener">strstr()</a> ä»¥åŠ Javaçš„ <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html#indexOf(java.lang.String)" target="_blank" rel="noopener">indexOf()</a> å®šä¹‰ç›¸ç¬¦ã€‚</p>
<p><strong>è§£æ³•ä¸€</strong></p>
<p>æ ‡æ³¨çš„æ˜¯ç®€å•ï¼Œå¾ˆå¤šäººéƒ½æ˜¯ç›´æ¥è°ƒçš„APIï¼Œä½†æ˜¯æˆ‘æ„Ÿè§‰æ²¡å•¥æ„ä¹‰ï¼Œæ‰€ä»¥è¿™é¢˜åº”è¯¥ç›´æ¥ä¸Škmp</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">strStr</span><span class="params">(String haystack, String needle)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(needle==<span class="keyword">null</span> || needle.length()&lt;=<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(haystack==<span class="keyword">null</span> ||haystack.length()&lt;=<span class="number">0</span>) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span>[] next=getNext(needle);</span><br><span class="line">    <span class="keyword">int</span> tidx=<span class="number">0</span>,sidx=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (sidx&lt;haystack.length() &amp;&amp; tidx&lt;needle.length()) &#123;</span><br><span class="line">        <span class="keyword">if</span>(needle.charAt(tidx) == haystack.charAt(sidx))&#123;</span><br><span class="line">            tidx++;sidx++;</span><br><span class="line">            <span class="keyword">if</span>(tidx==needle.length())&#123;</span><br><span class="line">                <span class="keyword">return</span> sidx-tidx;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(next[tidx]==-<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="comment">//å®Œå…¨å¤±é…sidxéœ€è¦åç§»</span></span><br><span class="line">            sidx++;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            tidx=next[tidx];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ±‚tçš„next</span></span><br><span class="line"><span class="comment">//abadabac</span></span><br><span class="line"><span class="comment">//ac</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">int</span>[] getNext(String t)&#123;</span><br><span class="line">    <span class="keyword">int</span>[] next= <span class="keyword">new</span> <span class="keyword">int</span>[t.length()];</span><br><span class="line">    next[<span class="number">0</span>]=-<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(t.length()&lt;=<span class="number">1</span>) <span class="keyword">return</span> next;</span><br><span class="line">    next[<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> left=<span class="number">0</span>,right=<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">while</span>(right&lt;t.length())&#123;</span><br><span class="line">        <span class="keyword">if</span>(t.charAt(left)==t.charAt(right-<span class="number">1</span>))&#123;</span><br><span class="line">            left++;</span><br><span class="line">            next[right++]=left;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(left&lt;=<span class="number">0</span>)&#123;</span><br><span class="line">            next[right++]=<span class="number">0</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            left=next[left];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> next;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ²¡å•¥å¥½è¯´çš„ï¼Œè£¸kmp</p>
<h3 id="459-é‡å¤çš„å­å­—ç¬¦ä¸²"><a href="#459-é‡å¤çš„å­å­—ç¬¦ä¸²" class="headerlink" title="459. é‡å¤çš„å­å­—ç¬¦ä¸²"></a><a href="https://leetcode-cn.com/problems/repeated-substring-pattern/" target="_blank" rel="noopener">459. é‡å¤çš„å­å­—ç¬¦ä¸²</a></h3><p>ç»™å®šä¸€ä¸ªéç©ºçš„å­—ç¬¦ä¸²ï¼Œåˆ¤æ–­å®ƒæ˜¯å¦å¯ä»¥ç”±å®ƒçš„ä¸€ä¸ªå­ä¸²é‡å¤å¤šæ¬¡æ„æˆã€‚ç»™å®šçš„å­—ç¬¦ä¸²åªå«æœ‰å°å†™è‹±æ–‡å­—æ¯ï¼Œå¹¶ä¸”é•¿åº¦ä¸è¶…è¿‡10000ã€‚</p>
<p><strong>ç¤ºä¾‹ 1:</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">è¾“å…¥: <span class="string">"abab"</span></span><br><span class="line"></span><br><span class="line">è¾“å‡º: True</span><br><span class="line"></span><br><span class="line">è§£é‡Š: å¯ç”±å­å­—ç¬¦ä¸² <span class="string">"ab"</span> é‡å¤ä¸¤æ¬¡æ„æˆã€‚</span><br></pre></td></tr></table></figure>

<p><strong>ç¤ºä¾‹ 2:</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">è¾“å…¥: <span class="string">"aba"</span></span><br><span class="line"></span><br><span class="line">è¾“å‡º: False</span><br></pre></td></tr></table></figure>

<p><strong>ç¤ºä¾‹ 3:</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">è¾“å…¥: <span class="string">"abcabcabcabc"</span></span><br><span class="line"></span><br><span class="line">è¾“å‡º: True</span><br><span class="line"></span><br><span class="line">è§£é‡Š: å¯ç”±å­å­—ç¬¦ä¸² <span class="string">"abc"</span> é‡å¤å››æ¬¡æ„æˆã€‚ (æˆ–è€…å­å­—ç¬¦ä¸² <span class="string">"abcabc"</span> é‡å¤ä¸¤æ¬¡æ„æˆã€‚)</span><br></pre></td></tr></table></figure>

<p><strong>è§£æ³•ä¸€</strong></p>
<p>è¿™é¢˜æ ‡æ³¨çš„ä¹Ÿæ˜¯ç®€å•ï¼Œç¡®å®æš´åŠ›çš„è§£æ³•ä¸éš¾æƒ³åˆ°ï¼Œä½†æ˜¯å¤æ‚åº¦æ¯”è¾ƒé«˜ï¼Œæ‰€ä»¥å°±ç›´æ¥ä¸Škmp</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//20msï¼Œåšå¤æ‚äº†ï¼Œæ„é€ äº†ä¸€ä¸ªs+sç„¶åå»æ‰å¤´ï¼Œå†åœ¨é‡Œé¢kmpæ‰¾</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">repeatedSubstringPattern</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(s==<span class="keyword">null</span> || s.length()&lt;=<span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    String t=s+s;</span><br><span class="line">    <span class="keyword">int</span>[] next=getNext(s);</span><br><span class="line">    <span class="keyword">int</span> i=<span class="number">0</span>,j=<span class="number">1</span>; <span class="comment">//å»æ‰å¤´</span></span><br><span class="line">    <span class="keyword">while</span>(i&lt;s.length() &amp;&amp; j&lt;t.length())&#123;</span><br><span class="line">        <span class="keyword">if</span>(s.charAt(i)==t.charAt(j))&#123;</span><br><span class="line">            i++;j++;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(next[i]==-<span class="number">1</span>)&#123;</span><br><span class="line">            j++;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            i=next[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> j-i!=s.length();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">int</span>[] getNext(String s)&#123;</span><br><span class="line">    <span class="keyword">if</span>(s.length()==<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;-<span class="number">1</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span>[] next=<span class="keyword">new</span> <span class="keyword">int</span>[s.length()];</span><br><span class="line">    next[<span class="number">0</span>]=-<span class="number">1</span>;</span><br><span class="line">    next[<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> left=<span class="number">0</span>,right=<span class="number">2</span>; </span><br><span class="line">    <span class="keyword">while</span>(right&lt;s.length())&#123;</span><br><span class="line">        <span class="keyword">if</span>(s.charAt(left)==s.charAt(right-<span class="number">1</span>))&#123;</span><br><span class="line">            next[right++]=++left;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(left&lt;=<span class="number">0</span>)&#123;</span><br><span class="line">            next[right++]=<span class="number">0</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            left=next[left];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> next;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªè§£æ³•å…¶å®æ„é€ äº†ä¸€ä¸ª<code>s+s</code>çš„å­—ç¬¦<code>t</code>ï¼Œç„¶åå»æ‰å¤´ï¼Œåœ¨<code>t[1:]</code>ä¸­æ‰¾åŸ<code>s</code>ï¼Œæœ€åæ‰¾åˆ°çš„ä½ç½®åªè¦ä¸æ˜¯<code>s+s</code>è¿æ¥å¤„ï¼Œä¹Ÿå°±æ˜¯<code>s.length()</code>ä½ç½®ï¼Œé‚£ä¹ˆå°±è‚¯å®šæ˜¯é‡å¤çš„æœ‰å¾ªç¯çš„ï¼Œå…¶å®è¿™ä¸ªç»“è®ºåœ¨å†™çš„æ—¶å€™å¹¶æ²¡æœ‰è¯æ˜ï¼Œå®Œå…¨æ˜¯çŒœçš„ğŸ˜‚ï¼Œç®€å•è¯æ˜ä¸‹ï¼Œä¸€å›¾èƒœå‰è¨€</p>
<p><img src="http://static.imlgw.top/blog/20200513/O4Nmz343e9Li.png?imageslim" alt="mark"></p>
<p><strong>è§£æ³•äºŒ</strong></p>
<p>å…¶å®åªéœ€è¦æ„é€ nextæ•°ç»„ï¼Œæ ¹æ®nextæ•°ç»„å°±å¯ä»¥åˆ¤æ–­æ˜¯ä¸æ˜¯é‡å¤çš„ï¼Œæˆ‘ä»¬çœ‹å‡ ç»„æ•°æ®</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">   s:  a b c a b c a b c a b c \<span class="number">0</span></span><br><span class="line">next: -<span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span> <span class="number">7</span> <span class="number">8</span>  <span class="number">9</span></span><br><span class="line">   s:  a a b a b d \<span class="number">0</span></span><br><span class="line">next: -<span class="number">1</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span>  <span class="number">0</span></span><br><span class="line">   s:  a b c d a b \<span class="number">0</span></span><br><span class="line">next: -<span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">2</span></span><br></pre></td></tr></table></figure>

<p>ç›¸æ¯”å¸¸è§„çš„KMPç®—æ³•ï¼Œæˆ‘ä»¬åœ¨å­—ç¬¦æœ€åæœ€åä¹ŸåŠ äº†<code>next</code>ä½ï¼Œå…¶å®æ˜¯ä¸ºäº†åŒºåˆ«ä¸‹é¢çš„æƒ…å†µ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">   s:  a b a b \0</span><br><span class="line">next: -1 0 0 1 2</span><br><span class="line">   s:  a b a c \0</span><br><span class="line">next: -1 0 0 1 0</span><br></pre></td></tr></table></figure>

<p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥å‘ç°ï¼Œnextæ•°ç»„åœ¨è¿‡äº†ä¸€å®šçš„èŒƒå›´åå°±å¼€å§‹é€æ¸é€’å¢äº†ï¼Œè€Œè¿™ä¸ªé€’å¢çš„æ‹ç‚¹å°±æ˜¯åœ¨ç¬¬ä¸€ä¸ªå¾ªç¯èŠ‚ç»“æŸçš„æ—¶å€™ï¼Œè‡³äºä¸ºä»€ä¹ˆæˆ‘å°±ä¸è¯¦ç»†è¯æ˜äº†ï¼Œå…¶å®ä¹Ÿå¾ˆå¥½æƒ³å› ä¸ºè¿‡äº†å¾ªç¯èŠ‚ï¼Œåé¢çš„éƒ½æ˜¯å’Œå‰é¢é‡å¤çš„ï¼Œæ‰€ä»¥æ¯å¤šä¸€ä¸ªå­—ç¬¦<code>next[i]=next[i-1]+1</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨å­—ç¬¦çš„é•¿åº¦å‡å»<code>next[slen]</code>å°±å¯ä»¥å¾—åˆ°å¾ªç¯ç»“çš„é•¿åº¦ï¼Œæˆ‘ä»¬åªéœ€è¦éªŒè¯è¿™ä¸ªå¾ªç¯èŠ‚èƒ½å¦è¢«<code>s</code>å­—ç¬¦ä¸²é•¿åº¦æ•´é™¤å°±å¯ä»¥äº†ï¼ŒåŒæ—¶éœ€è¦é˜²æ­¢å¾ªç¯èŠ‚é•¿åº¦ç­‰äºå­—ç¬¦ä¸²é•¿åº¦çš„æƒ…å†µ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">repeatedSubstringPattern</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(s==<span class="keyword">null</span> || s.length()&lt;=<span class="number">1</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">int</span>[] next=getNext(s);</span><br><span class="line">    <span class="keyword">int</span> replen=s.length()-next[s.length()];</span><br><span class="line">    <span class="keyword">return</span> s.length()%replen==<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">int</span>[] getNext(String s)&#123;</span><br><span class="line">    <span class="keyword">if</span>(s.length()==<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;-<span class="number">1</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span>[] next=<span class="keyword">new</span> <span class="keyword">int</span>[s.length()+<span class="number">1</span>];</span><br><span class="line">    next[<span class="number">0</span>]=-<span class="number">1</span>;</span><br><span class="line">    next[<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> left=<span class="number">0</span>,right=<span class="number">2</span>; </span><br><span class="line">    <span class="keyword">while</span>(right&lt;=s.length())&#123;</span><br><span class="line">        <span class="keyword">if</span>(s.charAt(left)==s.charAt(right-<span class="number">1</span>))&#123;</span><br><span class="line">            next[right++]=++left;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(left&lt;=<span class="number">0</span>)&#123;</span><br><span class="line">            next[right++]=<span class="number">0</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            left=next[left];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> next;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å®åœ¨ä¸è¡ŒæŠŠè¿™ä¸ªè®°ä½å°±è¡Œäº†ï¼Œåæ­£æˆ‘æ˜¯è®°ä½äº†ğŸ˜‚</p>

    </div>

  </article>
  <div class="toc-container">
    
  <div id="toc" class="toc-article">
    <strong class="toc-title">ç›®å½•</strong>
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#å‰è¨€"><span class="toc-text">å‰è¨€</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#nextæ•°ç»„æ˜¯ä»€ä¹ˆï¼Ÿ"><span class="toc-text">nextæ•°ç»„æ˜¯ä»€ä¹ˆï¼Ÿ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#nextæ•°ç»„çš„ä½œç”¨ï¼Ÿ"><span class="toc-text">nextæ•°ç»„çš„ä½œç”¨ï¼Ÿ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ä¸ºä»€ä¹ˆå­ä¸²å¯ä»¥ç›´æ¥æ»‘åŠ¨next-i-æ­¥ï¼Ÿ"><span class="toc-text">ä¸ºä»€ä¹ˆå­ä¸²å¯ä»¥ç›´æ¥æ»‘åŠ¨next[i]æ­¥ï¼Ÿ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#nextæ•°ç»„å¦‚ä½•æ±‚ï¼Ÿ"><span class="toc-text">nextæ•°ç»„å¦‚ä½•æ±‚ï¼Ÿ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#æ—¶é—´å¤æ‚åº¦ä¸ºä»€ä¹ˆæ˜¯çº¿æ€§çš„ï¼Ÿ"><span class="toc-text">æ—¶é—´å¤æ‚åº¦ä¸ºä»€ä¹ˆæ˜¯çº¿æ€§çš„ï¼Ÿ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ä¾‹é¢˜"><span class="toc-text">ä¾‹é¢˜</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#28-å®ç°-strStr"><span class="toc-text">28. å®ç° strStr()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#459-é‡å¤çš„å­å­—ç¬¦ä¸²"><span class="toc-text">459. é‡å¤çš„å­å­—ç¬¦ä¸²</span></a></li></ol></li></ol>
  </div>


  </div>
</div>


    <section id="comments" style="margin:10px;padding:10px;background:#fff;">
      <div id="vcomment" class="comment"></div> 
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="//unpkg.com/valine/dist/Valine.min.js"></script>
<script>
   var notify = 'false' == true ? true : false;
   var verify = 'true' == true ? true : false;
    window.onload = function() {
        new Valine({
            el: '.comment',
            notify: notify,
            verify: verify,
            app_id: "MkcXmeDvktRNBDBrVqb9KYPH-MdYXbMMI",
            app_key: "swDnb5a9u9Ksp2Rwkdm7Qulh",
            placeholder: "ç•™ä¸‹é‚®ç®±æ‰èƒ½æ”¶åˆ°æ”¶åˆ°å›å¤å–” ~",
            avatar:"monsterid"
        });
    }
</script>
    </section>
  
<div class="copyright">
    <span>æœ¬ä½œå“é‡‡ç”¨</span>
    <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="noopener">çŸ¥è¯†å…±äº«ç½²å 4.0 å›½é™…è®¸å¯åè®®</a>
    <span>è¿›è¡Œè®¸å¯ã€‚ è½¬è½½æ—¶è¯·æ³¨æ˜åŸæ–‡é“¾æ¥ã€‚</span>
</div>


  
    <div class="post-nav">
      <div class="post-nav-item post-nav-next">
        
          <span>ã€ˆ </span>
          <a href="/2020/02/02/bing-cha-ji/" rel="next" title="å¹¶æŸ¥é›†">
          å¹¶æŸ¥é›†
          </a>
        
      </div>
  
      <div class="post-nav-item post-nav-prev">
          
      </div>
    </div>
  

    </div>

    

  </div>
  <footer class="footer text-center">
    <div id="bottom-inner">
        <a class="bottom-item" href="https://github.com/imlgw" target="_blank">GitHub</a> |
        <a class="bottom-item" href="/links">å‹æƒ…é“¾æ¥</a> |
        <a class="bottom-item" href="https://hexo.io" target="_blank">Powered by hexo</a> |
        <a class="bottom-item" href="https://github.com/fooying/hexo-theme-xoxo-plus" target="_blank">Theme xoxo-plus</a> |
        <a class="bottom-item" href="https://imlgw.avosapps.us/" target="_blank" rel="noopener">åšå®¢è¯„è®ºç®¡ç†</a>
    </div>
</footer>

  

<script>
  (function(window, document, undefined) {

    var timer = null;

    function returnTop() {
      cancelAnimationFrame(timer);
      timer = requestAnimationFrame(function fn() {
        var oTop = document.body.scrollTop || document.documentElement.scrollTop;
        if (oTop > 0) {
          document.body.scrollTop = document.documentElement.scrollTop = oTop - 50;
          timer = requestAnimationFrame(fn);
        } else {
          cancelAnimationFrame(timer);
        }
      });
    }

    var hearts = [];
    window.requestAnimationFrame = (function() {
      return window.requestAnimationFrame ||
        window.webkitRequestAnimationFrame ||
        window.mozRequestAnimationFrame ||
        window.oRequestAnimationFrame ||
        window.msRequestAnimationFrame ||
        function(callback) {
          setTimeout(callback, 1000 / 60);
        }
    })();
    init();

    function init() {
      css(".heart{z-index:9999;width: 10px;height: 10px;position: fixed;background: #f00;transform: rotate(45deg);-webkit-transform: rotate(45deg);-moz-transform: rotate(45deg);}.heart:after,.heart:before{content: '';width: inherit;height: inherit;background: inherit;border-radius: 50%;-webkit-border-radius: 50%;-moz-border-radius: 50%;position: absolute;}.heart:after{top: -5px;}.heart:before{left: -5px;}");
      attachEvent();
      gameloop();
      addMenuEvent();
    }

    function gameloop() {
      for (var i = 0; i < hearts.length; i++) {
        if (hearts[i].alpha <= 0) {
          document.body.removeChild(hearts[i].el);
          hearts.splice(i, 1);
          continue;
        }
        hearts[i].y--;
        hearts[i].scale += 0.004;
        hearts[i].alpha -= 0.013;
        hearts[i].el.style.cssText = "left:" + hearts[i].x + "px;top:" + hearts[i].y + "px;opacity:" + hearts[i].alpha + ";transform:scale(" + hearts[i].scale + "," + hearts[i].scale + ") rotate(45deg);background:" + hearts[i].color;
      }
      requestAnimationFrame(gameloop);
    }

    /**
     * ç»™logoè®¾ç½®ç‚¹å‡»äº‹ä»¶
     * 
     * - å›åˆ°é¡¶éƒ¨
     * - å‡ºç°çˆ±å¿ƒ
     */
    function attachEvent() {
      var old = typeof window.onclick === "function" && window.onclick;
      var logo = document.getElementById("logo");
      if (logo) {
        logo.onclick = function(event) {
          returnTop();
          old && old();
          createHeart(event);
        }
      }
      
    }

    function createHeart(event) {
      var d = document.createElement("div");
      d.className = "heart";
      hearts.push({
        el: d,
        x: event.clientX - 5,
        y: event.clientY - 5,
        scale: 1,
        alpha: 1,
        color: randomColor()
      });
      document.body.appendChild(d);
    }

    function css(css) {
      var style = document.createElement("style");
      style.type = "text/css";
      try {
        style.appendChild(document.createTextNode(css));
      } catch (ex) {
        style.styleSheet.cssText = css;
      }
      document.getElementsByTagName('head')[0].appendChild(style);
    }

    function randomColor() {
      // return "rgb(" + (~~(Math.random() * 255)) + "," + (~~(Math.random() * 255)) + "," + (~~(Math.random() * 255)) + ")";
      return "#F44336";
    }

    function addMenuEvent() {
      var menu = document.getElementById('menu-main-post');
      if (menu) {
        var toc = document.getElementById('toc');
        if (toc) {
          menu.onclick = function() {
            if (toc) {
              if (toc.style.display == 'block') {
                toc.style.display = 'none';
              } else {
                toc.style.display = 'block';
              }
            }
          };
        } else {
          menu.style.display = 'none';
        }
      }
    }

  })(window, document);
</script>

  



  

<script src="https://cdn.jsdelivr.net/npm/live2d-widget@3.x/lib/L2Dwidget.min.js"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"https://cdn.jsdelivr.net/npm/live2d-widget-model-hijiki@1.0.5/assets/hijiki.model.json"},"display":{"superSample":2,"width":160,"height":320,"position":"right","hOffset":0,"vOffset":-70},"mobile":{"show":false,"scale":0.2},"log":false});</script></body>
</html>
